sudo: required
dist: trusty

language: generic

matrix:
  include:
    - compiler: gcc
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-4.9
      env: 
        - CXX=g++-4.9 CC=gcc-4.9 MODE=Debug
        - CXX=g++-4.9 CC=gcc-4.9 MODE=Release
    - compiler: clang
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
            - llvm-toolchain-precise-3.6
          packages:
            - clang-3.6
      env: 
        - CXX=clang++-3.6 CC=clang-3.6 MODE=Debug
        - CXX=clang++-3.6 CC=clang-3.6 MODE=Release

install:
  # install cmake 2.8.12 manually, see
  #     * https://github.com/travis-ci-tester/travis-test-cmake
  - wget http://www.cmake.org/files/v3.6/cmake-3.6.1.tar.gz
  - tar xf cmake-3.6.1.tar.gz
  - cd cmake-3.6.1
  - ./bootstrap --system-curl
  - make
  - sudo make install
  - cd ..
  # -- end
  
script:
  - mkdir release
  - cd release
  # Automatic detection of your arch, compiler, etc
  - cmake ../.. -DCMAKE_BUILD_TYPE=$MODE -DCMAKE_MODULE_PATH=$(pwd)/../../cmaki -DFIRST_ERROR=1 -G"Unix Makefiles" -DCMAKE_C_COMPILER="$CC" -DCMAKE_CXX_COMPILER="$CXX"
  - cmake --build . --config $MODE --target install -- -j8 -k || cmake --build . --config $MODE --target install -- -j1
  - ctest . --no-compress-output --output-on-failure -T Test -C $MODE -V

